--- /home/V1SCAN/CWE-834/FormattedVul/OLD##CVE-2018-11813##0##libjpeg-turbo@@libjpeg-turbo##rdtarga.c	2023-12-12 04:29:03.095074293 +0900
+++ /home/V1SCAN/CWE-834/FormattedPatch/NEW##CVE-2018-11813##0##libjpeg-turbo@@libjpeg-turbo##rdtarga.c	2023-12-12 04:29:03.115074375 +0900
@@ -115,11 +115,10 @@
 read_non_rle_pixel(tga_source_ptr sinfo)
 /* Read one Targa pixel from the input file; no RLE expansion */
 {
-  register FILE *infile = sinfo->pub.input_file;
   register int i;
 
   for (i = 0; i < sinfo->pixel_size; i++) {
-    sinfo->tga_pixel[i] = (U_CHAR)getc(infile);
+    sinfo->tga_pixel[i] = (U_CHAR)read_byte(sinfo);
   }
 }
 
@@ -127,7 +126,6 @@
 read_rle_pixel(tga_source_ptr sinfo)
 /* Read one Targa pixel from the input file, expanding RLE data as needed */
 {
-  register FILE *infile = sinfo->pub.input_file;
   register int i;
 
   /* Duplicate previously read pixel? */
@@ -149,7 +147,7 @@
 
   /* Read next pixel */
   for (i = 0; i < sinfo->pixel_size; i++) {
-    sinfo->tga_pixel[i] = (U_CHAR)getc(infile);
+    sinfo->tga_pixel[i] = (U_CHAR)read_byte(sinfo);
   }
 }
 
