--- /home/V1SCAN/CWE-617/FormattedVul/OLD##CVE-2019-18844##0##projectacrn@@acrn-hypervisor##core.c	2023-12-12 04:07:13.009437023 +0900
+++ /home/V1SCAN/CWE-617/FormattedPatch/NEW##CVE-2019-18844##0##projectacrn@@acrn-hypervisor##core.c	2023-12-12 04:07:13.539435740 +0900
@@ -389,11 +389,10 @@
   uint64_t offset;
   int bidx = (int)arg2;
 
-  assert(bidx <= PCI_BARMAX);
-  assert(pdi->bar[bidx].type == PCIBAR_MEM32 ||
-         pdi->bar[bidx].type == PCIBAR_MEM64);
-  assert(addr >= pdi->bar[bidx].addr &&
-         addr + size <= pdi->bar[bidx].addr + pdi->bar[bidx].size);
+  if (addr + size > pdi->bar[bidx].addr + pdi->bar[bidx].size) {
+    printf("%s, Out of emulated memory range.\n", __func__);
+    return -ESRCH;
+  }
 
   offset = addr - pdi->bar[bidx].addr;
 
