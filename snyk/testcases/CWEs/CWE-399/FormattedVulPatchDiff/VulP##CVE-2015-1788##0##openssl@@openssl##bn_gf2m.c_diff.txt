--- /home/V1SCAN/CWE-399/FormattedVul/OLD##CVE-2015-1788##0##openssl@@openssl##bn_gf2m.c	2023-12-12 05:12:51.540128429 +0900
+++ /home/V1SCAN/CWE-399/FormattedPatch/NEW##CVE-2015-1788##0##openssl@@openssl##bn_gf2m.c	2023-12-12 05:12:51.590138685 +0900
@@ -678,9 +678,10 @@
     }
 #else
   {
-    int i, ubits = BN_num_bits(u), vbits = BN_num_bits(v), /* v is copy
-                                                            * of p */
-        top = p->top;
+    int i;
+    int ubits = BN_num_bits(u);
+    int vbits = BN_num_bits(v); /* v is copy of p */
+    int top = p->top;
     BN_ULONG *udp, *bdp, *vdp, *cdp;
 
     bn_wexpand(u, top);
@@ -724,8 +725,12 @@
         ubits--;
       }
 
-      if (ubits <= BN_BITS2 && udp[0] == 1)
-        break;
+      if (ubits <= BN_BITS2) {
+        if (udp[0] == 0) /* poly was reducible */
+          goto err;
+        if (udp[0] == 1)
+          break;
+      }
 
       if (ubits < vbits) {
         i = ubits;
