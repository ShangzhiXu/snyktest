--- /home/V1SCAN/CWE-119/FormattedUsed/dict-turicreate-6.4.1.c	2023-12-10 02:45:00.710138683 +0900
+++ /home/V1SCAN/CWE-119/FormattedPatch/NEW##CVE-2015-7497##0##GNOME@@libxml2##dict.c	2023-12-10 02:45:01.480177645 +0900
@@ -499,7 +499,10 @@
     value += 30 * (*prefix);
 
   if (len > 10) {
-    value += name[len - (plen + 1 + 1)];
+    int offset = len - (plen + 1 + 1);
+    if (offset < 0)
+      offset = len - (10 + 1);
+    value += name[offset];
     len = 10;
     if (plen > 10)
       plen = 10;
