--- /home/V1SCAN/CWE-119/FormattedUsed/tool_writeout-turicreate-6.4.1.c	2023-12-10 02:45:01.410174104 +0900
+++ /home/V1SCAN/CWE-119/FormattedPatch/NEW##CVE-2017-7407##0##curl@@curl##tool_writeout.c	2023-12-10 02:45:02.140211042 +0900
@@ -5,7 +5,7 @@
  *                            | (__| |_| |  _ <| |___
  *                             \___|\___/|_| \_\_____|
  *
- * Copyright (C) 1998 - 2018, Daniel Stenberg, <daniel@haxx.se>, et al.
+ * Copyright (C) 1998 - 2016, Daniel Stenberg, <daniel@haxx.se>, et al.
  *
  * This software is licensed as described in the file COPYING, which
  * you should have received as part of this distribution. The terms
@@ -60,8 +60,6 @@
   VAR_LOCAL_PORT,
   VAR_HTTP_VERSION,
   VAR_SCHEME,
-  VAR_STDOUT,
-  VAR_STDERR,
   VAR_NUM_OF_VARS /* must be the last */
 } replaceid;
 
@@ -102,8 +100,6 @@
     {"local_port", VAR_LOCAL_PORT},
     {"http_version", VAR_HTTP_VERSION},
     {"scheme", VAR_SCHEME},
-    {"stdout", VAR_STDOUT},
-    {"stderr", VAR_STDERR},
     {NULL, VAR_NONE}};
 
 void ourWriteOut(CURL *curl, struct OutStruct *outs, const char *writeinfo) {
@@ -122,9 +118,9 @@
       } else {
         /* this is meant as a variable to output */
         char *end;
+        char keepit;
+        int i;
         if ('{' == ptr[1]) {
-          char keepit;
-          int i;
           bool match = FALSE;
           end = strchr(ptr, '}');
           ptr += 2; /* pass the % and the { */
@@ -311,12 +307,6 @@
                     curl_easy_getinfo(curl, CURLINFO_SCHEME, &stringp))
                   fprintf(stream, "%s", stringp);
                 break;
-              case VAR_STDOUT:
-                stream = stdout;
-                break;
-              case VAR_STDERR:
-                stream = stderr;
-                break;
               default:
                 break;
               }
@@ -335,7 +325,7 @@
           ptr += 2;
         }
       }
-    } else if ('\\' == *ptr && ptr[1]) {
+    } else if ('\\' == *ptr) {
       switch (ptr[1]) {
       case 'r':
         fputc('\r', stream);
