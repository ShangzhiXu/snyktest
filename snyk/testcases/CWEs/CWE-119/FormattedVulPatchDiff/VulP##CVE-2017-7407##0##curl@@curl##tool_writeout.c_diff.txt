--- /home/V1SCAN/CWE-119/FormattedVul/OLD##CVE-2017-7407##0##curl@@curl##tool_writeout.c	2023-12-10 02:44:15.010183914 +0900
+++ /home/V1SCAN/CWE-119/FormattedPatch/NEW##CVE-2017-7407##0##curl@@curl##tool_writeout.c	2023-12-10 02:44:15.700180599 +0900
@@ -110,7 +110,7 @@
   double doubleinfo;
 
   while (ptr && *ptr) {
-    if ('%' == *ptr) {
+    if ('%' == *ptr && ptr[1]) {
       if ('%' == ptr[1]) {
         /* an escaped %-letter */
         fputc('%', stream);
