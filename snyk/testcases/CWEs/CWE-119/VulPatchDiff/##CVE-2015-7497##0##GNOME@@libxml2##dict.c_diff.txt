--- /home/V1SCAN/CWE-119/vul/OLD##CVE-2015-7497##0##GNOME@@libxml2##dict.c	2023-11-08 07:54:43.156166400 +0900
+++ /home/V1SCAN/CWE-119/patch/NEW##CVE-2015-7497##0##GNOME@@libxml2##dict.c	2023-11-08 07:54:43.166166391 +0900
@@ -486,7 +486,10 @@
 	value += 30 * (*prefix);
 
     if (len > 10) {
-        value += name[len - (plen + 1 + 1)];
+        int offset = len - (plen + 1 + 1);
+	if (offset < 0)
+	    offset = len - (10 + 1);
+	value += name[offset];
         len = 10;
 	if (plen > 10)
 	    plen = 10;
