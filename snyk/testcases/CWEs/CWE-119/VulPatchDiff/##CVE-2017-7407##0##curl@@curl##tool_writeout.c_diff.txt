--- /home/V1SCAN/CWE-119/vul/OLD##CVE-2017-7407##0##curl@@curl##tool_writeout.c	2023-11-08 07:54:43.156166400 +0900
+++ /home/V1SCAN/CWE-119/patch/NEW##CVE-2017-7407##0##curl@@curl##tool_writeout.c	2023-11-08 07:54:43.166166391 +0900
@@ -113,7 +113,7 @@
   double doubleinfo;
 
   while(ptr && *ptr) {
-    if('%' == *ptr) {
+    if('%' == *ptr && ptr[1]) {
       if('%' == ptr[1]) {
         /* an escaped %-letter */
         fputc('%', stream);
