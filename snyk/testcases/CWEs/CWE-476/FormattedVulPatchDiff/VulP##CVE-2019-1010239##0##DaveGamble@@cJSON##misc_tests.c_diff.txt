--- /home/V1SCAN/CWE-476/FormattedVul/OLD##CVE-2019-1010239##0##DaveGamble@@cJSON##misc_tests.c	2023-12-06 03:48:08.792280802 +0900
+++ /home/V1SCAN/CWE-476/FormattedPatch/NEW##CVE-2019-1010239##0##DaveGamble@@cJSON##misc_tests.c	2023-12-06 03:48:09.242282137 +0900
@@ -122,6 +122,29 @@
   cJSON_Delete(item);
 }
 
+static void cjson_get_object_item_should_not_crash_with_array(void) {
+  cJSON *array = NULL;
+  cJSON *found = NULL;
+  array = cJSON_Parse("[1]");
+
+  found = cJSON_GetObjectItem(array, "name");
+  TEST_ASSERT_NULL(found);
+
+  cJSON_Delete(array);
+}
+
+static void
+cjson_get_object_item_case_sensitive_should_not_crash_with_array(void) {
+  cJSON *array = NULL;
+  cJSON *found = NULL;
+  array = cJSON_Parse("[1]");
+
+  found = cJSON_GetObjectItemCaseSensitive(array, "name");
+  TEST_ASSERT_NULL(found);
+
+  cJSON_Delete(array);
+}
+
 static void typecheck_functions_should_check_type(void) {
   cJSON invalid[1];
   cJSON item[1];
@@ -547,6 +570,8 @@
   RUN_TEST(cjson_array_foreach_should_not_dereference_null_pointer);
   RUN_TEST(cjson_get_object_item_should_get_object_items);
   RUN_TEST(cjson_get_object_item_case_sensitive_should_get_object_items);
+  RUN_TEST(cjson_get_object_item_should_not_crash_with_array);
+  RUN_TEST(cjson_get_object_item_case_sensitive_should_not_crash_with_array);
   RUN_TEST(typecheck_functions_should_check_type);
   RUN_TEST(cjson_should_not_parse_to_deeply_nested_jsons);
   RUN_TEST(cjson_set_number_value_should_set_numbers);
