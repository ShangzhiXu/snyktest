@@ -2281,6 +2281,13 @@
     /*
      * Read signature
      */
+
+    if (p > end - 2) {
+      MBEDTLS_SSL_DEBUG_MSG(1, ("bad server key exchange message"));
+      mbedtls_ssl_send_alert_message(ssl, MBEDTLS_SSL_ALERT_LEVEL_FATAL,MBEDTLS_SSL_ALERT_MSG_DECODE_ERROR);
+      return (MBEDTLS_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE);
+    }
     sig_len = (p[0] << 8) | p[1];
     p += 2;
 
