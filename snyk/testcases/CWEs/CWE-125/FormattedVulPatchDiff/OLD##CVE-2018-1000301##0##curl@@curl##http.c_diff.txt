--- /home/V1SCAN/CWE-125/FormattedVul/OLD##CVE-2018-1000301##0##curl@@curl##http.c	2023-12-01 06:27:18.216896310 +0900
+++ /home/V1SCAN/CWE-125/FormattedPatch/NEW##CVE-2018-1000301##0##curl@@curl##http.c	2023-12-01 06:27:17.015937077 +0900
@@ -2872,6 +2872,8 @@
                                      bool *stop_reading) {
   CURLcode result;
   struct SingleRequest *k = &data->req;
+  ssize_t onread = *nread;
+  char *ostr = k->str;
 
   /* header line within buffer loop */
   do {
@@ -2936,7 +2938,9 @@
         else {
           /* this was all we read so it's all a bad header */
           k->badheader = HEADER_ALLBAD;
-          *nread = (ssize_t)rest_length;
+          *nread = onread;
+          k->str = ostr;
+          return CURLE_OK;
         }
         break;
       }
