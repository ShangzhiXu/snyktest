--- /home/V1SCAN/CWE-125/FormattedVul/OLD##CVE-2020-24977##0##GNOME@@libxml2##xmllint.c	2023-12-01 06:27:19.256894726 +0900
+++ /home/V1SCAN/CWE-125/FormattedPatch/NEW##CVE-2020-24977##0##GNOME@@libxml2##xmllint.c	2023-12-01 06:27:18.076896522 +0900
@@ -490,6 +490,12 @@
 static void xmlHTMLEncodeSend(void) {
   char *result;
 
+  /*
+   * xmlEncodeEntitiesReentrant assumes valid UTF-8, but the buffer might
+   * end with a truncated UTF-8 sequence. This is a hack to at least avoid
+   * an out-of-bounds read.
+   */
+  memset(&buffer[sizeof(buffer) - 4], 0, 4);
   result = (char *)xmlEncodeEntitiesReentrant(NULL, BAD_CAST buffer);
   if (result) {
     xmlGenericError(xmlGenericErrorContext, "%s", result);
