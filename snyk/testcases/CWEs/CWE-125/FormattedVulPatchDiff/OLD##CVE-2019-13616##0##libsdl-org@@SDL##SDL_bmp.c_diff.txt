--- /home/V1SCAN/CWE-125/FormattedVul/OLD##CVE-2019-13616##0##libsdl-org@@SDL##SDL_bmp.c	2023-12-01 06:27:18.856895334 +0900
+++ /home/V1SCAN/CWE-125/FormattedPatch/NEW##CVE-2019-13616##0##libsdl-org@@SDL##SDL_bmp.c	2023-12-01 06:27:17.666897147 +0900
@@ -224,6 +224,11 @@
       SDL_RWseek(src, (biSize - headerSize), RW_SEEK_CUR);
     }
   }
+  if (biWidth <= 0 || biHeight == 0) {
+    SDL_SetError("BMP file with bad dimensions (%dx%d)", biWidth, biHeight);
+    was_error = SDL_TRUE;
+    goto done;
+  }
   if (biHeight < 0) {
     topDown = SDL_TRUE;
     biHeight = -biHeight;
