--- /home/V1SCAN/CWE-125/FormattedUsed/SDL_bmp-filament-1.9.9.c	2023-12-10 02:51:50.408374620 +0900
+++ /home/V1SCAN/CWE-125/FormattedPatch/NEW##CVE-2019-7638##0##libsdl-org@@SDL##SDL_bmp.c	2023-12-10 02:51:52.368359262 +0900
@@ -1,6 +1,6 @@
 /*
   Simple DirectMedia Layer
-  Copyright (C) 1997-2018 Sam Lantinga <slouken@libsdl.org>
+  Copyright (C) 1997-2019 Sam Lantinga <slouken@libsdl.org>
 
   This software is provided 'as-is', without any express or implied
   warranty.  In no event will the authors be held liable for any damages
@@ -310,6 +310,10 @@
     SDL_assert(biBitCount <= 8);
     if (biClrUsed == 0) {
       biClrUsed = 1 << biBitCount;
+    } else if (biClrUsed > (1 << biBitCount)) {
+      SDL_SetError("BMP file has an invalid number of colors");
+      was_error = SDL_TRUE;
+      goto done;
     }
     if ((int)biClrUsed > palette->ncolors) {
       SDL_Color *colors;
