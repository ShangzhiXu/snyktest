--- /home/V1SCAN/CWE-787/FormattedVul/OLD##CVE-2016-10196##0##libevent@@libevent##evutil.c	2023-12-06 04:37:17.000325919 +0900
+++ /home/V1SCAN/CWE-787/FormattedPatch/NEW##CVE-2016-10196##0##libevent@@libevent##evutil.c	2023-12-06 04:37:18.730321683 +0900
@@ -1935,12 +1935,12 @@
 
   cp = strchr(ip_as_string, ':');
   if (*ip_as_string == '[') {
-    int len;
+    size_t len;
     if (!(cp = strchr(ip_as_string, ']'))) {
       return -1;
     }
-    len = (int)(cp - (ip_as_string + 1));
-    if (len > (int)sizeof(buf) - 1) {
+    len = (cp - (ip_as_string + 1));
+    if (len > sizeof(buf) - 1) {
       return -1;
     }
     memcpy(buf, ip_as_string + 1, len);
