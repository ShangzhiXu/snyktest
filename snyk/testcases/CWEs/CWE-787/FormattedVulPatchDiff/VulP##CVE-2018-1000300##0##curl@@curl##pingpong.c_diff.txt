--- /home/V1SCAN/CWE-787/FormattedVul/OLD##CVE-2018-1000300##0##curl@@curl##pingpong.c	2023-12-06 04:37:17.240325332 +0900
+++ /home/V1SCAN/CWE-787/FormattedPatch/NEW##CVE-2018-1000300##0##curl@@curl##pingpong.c	2023-12-06 04:37:18.970321096 +0900
@@ -289,7 +289,10 @@
        * it would have been populated with something of size int to begin
        * with, even though its datatype may be larger than an int.
        */
-      DEBUGASSERT((ptr + pp->cache_size) <= (buf + data->set.buffer_size + 1));
+      if ((ptr + pp->cache_size) > (buf + data->set.buffer_size + 1)) {
+        failf(data, "cached response data too big to handle");
+        return CURLE_RECV_ERROR;
+      }
       memcpy(ptr, pp->cache, pp->cache_size);
       gotbytes = (ssize_t)pp->cache_size;
       free(pp->cache);    /* free the cache */
