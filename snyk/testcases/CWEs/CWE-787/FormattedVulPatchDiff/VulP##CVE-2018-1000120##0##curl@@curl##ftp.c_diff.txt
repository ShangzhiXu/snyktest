--- /home/V1SCAN/CWE-787/FormattedVul/OLD##CVE-2018-1000120##0##curl@@curl##ftp.c	2023-12-06 04:37:17.230325355 +0900
+++ /home/V1SCAN/CWE-787/FormattedPatch/NEW##CVE-2018-1000120##0##curl@@curl##ftp.c	2023-12-06 04:37:18.960321122 +0900
@@ -1382,7 +1382,7 @@
       slashPos = strrchr(inpath, '/');
       n = slashPos - inpath;
     }
-    result = Curl_urldecode(data, inpath, n, &lstArg, NULL, FALSE);
+    result = Curl_urldecode(data, inpath, n, &lstArg, NULL, TRUE);
     if (result)
       return result;
   }
@@ -3000,7 +3000,7 @@
 
   if (!result)
     /* get the "raw" path */
-    result = Curl_urldecode(data, path_to_use, 0, &path, NULL, FALSE);
+    result = Curl_urldecode(data, path_to_use, 0, &path, NULL, TRUE);
   if (result) {
     /* We can limp along anyway (and should try to since we may already be in
      * the error path) */
@@ -3922,7 +3922,7 @@
 
       result =
           Curl_urldecode(conn->data, slash_pos ? cur_pos : "/",
-                         slash_pos ? dirlen : 1, &ftpc->dirs[0], NULL, FALSE);
+                         slash_pos ? dirlen : 1, &ftpc->dirs[0], NULL, TRUE);
       if (result) {
         freedirs(ftpc);
         return result;
@@ -4024,7 +4024,7 @@
     size_t dlen;
     char *path;
     CURLcode result =
-        Curl_urldecode(conn->data, data->state.path, 0, &path, &dlen, FALSE);
+        Curl_urldecode(conn->data, data->state.path, 0, &path, &dlen, TRUE);
     if (result) {
       freedirs(ftpc);
       return result;
